# NestJS æ˜¯ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆé€‰æ‹©å®ƒ

åœ¨ç°åœ¨è¿™ä¸ªç»æµå¤è‹çš„æ—¶ä»£ï¼Œåˆ›æ„å¾€å¾€éœ€è¦æŠ€æœ¯å»æ”¯æŒã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¥½çš„åˆ›æ„ï¼Œæ­£å¥½ä½ ä¹Ÿæ˜¯ä¸€åå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆã€‚NestJSæ˜¯ä½ å¿«é€Ÿè¿›å…¥åç«¯çš„ä¸€ä¸ªæ¡†æ¶ï¼Œå­¦ä¹ å®ƒä¸éœ€è¦NodejsçŸ¥è¯†ï¼Œå› ä¸ºè¿™ä¸ªæ¡†æ¶å·²ç»å¾ˆå¥½çš„å¸®æˆ‘ä»¬å»åšå¥½åº•å±‚å°è£…äº†ã€‚å¦‚æœæœ‰å…´è¶£å¯¹åº•å±‚æ„Ÿå…´è¶£ï¼Œå¯ä»¥å…³æ³¨æˆ‘çš„githubï¼Œåç»­æˆ‘ä¼šå‡ºä¸€ä¸ªæºç è§£è¯»ã€‚

å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´éå¸¸å‹å¥½ï¼Œå®ƒæ”¯æŒäº†`Javascript`å’Œ`Typescript` å¹¶ç»“åˆäº† OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰ã€FPï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼‰å’Œ FRPï¼ˆå‡½æ•°å¼ååº”å¼ç¼–ç¨‹ï¼‰ã€‚

## âœ… NestJS çš„æ ¸å¿ƒç‰¹ç‚¹åŒ…æ‹¬ï¼š

- åŸºäºæ¨¡å—çš„æ¶æ„ï¼šé¼“åŠ±è‰¯å¥½çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œæ¯ä¸ªåŠŸèƒ½å¯ä»¥ä½œä¸ºæ¨¡å—æ‹†åˆ†ã€‚

- ä½¿ç”¨è£…é¥°å™¨ï¼ˆDecoratorsï¼‰ï¼šå— Angular å¯å‘ï¼Œä½¿ç”¨è£…é¥°å™¨æ¥å®šä¹‰æ§åˆ¶å™¨ã€æœåŠ¡ã€æ¨¡å—ç­‰ã€‚

- å†…ç½®ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼šç±»ä¼¼äº Angularã€Spring çš„ä¾èµ–æ³¨å…¥æœºåˆ¶ã€‚

- æ”¯æŒå¤šç§ä¼ è¾“å±‚ï¼šä¸ä»…æ”¯æŒ HTTPï¼Œè¿˜æ”¯æŒ WebSocketsã€gRPCã€MQTT ç­‰ã€‚

- ä¸ Expressï¼ˆé»˜è®¤ï¼‰æˆ– Fastify é›†æˆï¼šNestJS æŠ½è±¡äº†åº•å±‚ HTTP å¹³å°ï¼Œå¼€å‘è€…å¯ä»¥é€‰æ‹©ä½¿ç”¨ Express æˆ– Fastifyã€‚

- å¼ºå¤§çš„ CLI å·¥å…·ï¼šå¸®åŠ©ç”Ÿæˆæ¨¡å—ã€æœåŠ¡ã€æ§åˆ¶å™¨ç­‰ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚

## ğŸ¯ ä¸ºä»€ä¹ˆé€‰æ‹© NestJSï¼Ÿ

1. ç»“æ„æ¸…æ™°ï¼Œé€‚åˆå¤§å‹é¡¹ç›®
- é¡¹ç›®æŒ‰ç…§æ¨¡å—ç»„ç»‡ï¼Œæœ‰åŠ©äºå›¢é˜Ÿåä½œå’Œä»£ç ç»´æŠ¤ã€‚
- éµå¾ª SOLID åŸåˆ™ï¼Œæå‡ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æµ‹è¯•æ€§ã€‚

2. TypeScript åŸç”Ÿæ”¯æŒ
- æä¾›æ›´å¥½çš„ç±»å‹æ£€æŸ¥ã€è‡ªåŠ¨è¡¥å…¨å’Œä»£ç å¯¼èˆªã€‚
- æå‡ä»£ç è´¨é‡ï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚

3. ä¾èµ–æ³¨å…¥æœºåˆ¶
- æ˜“äºç®¡ç†ä¾èµ–å…³ç³»ã€‚
- æœ‰åˆ©äºç¼–å†™å¯æµ‹è¯•çš„ä»£ç ï¼ˆä¾‹å¦‚å•å…ƒæµ‹è¯•å’Œ mock æœåŠ¡ï¼‰ã€‚

4. æ”¯æŒå¤šç§é€šä¿¡åè®®
- ä¸ä»…é™äº REST APIï¼Œè¿˜å¯ä»¥ç”¨äºæ„å»ºå¾®æœåŠ¡æ¶æ„ï¼ˆé€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—ã€gRPC ç­‰ï¼‰ã€‚

5. ç”Ÿæ€ä¸°å¯Œ
- å®˜æ–¹æ”¯æŒçš„æ¨¡å—å¾ˆå¤šï¼ˆå¦‚é…ç½®ç®¡ç†ã€éªŒè¯ã€ç¼“å­˜ã€é˜Ÿåˆ—ã€æ—¥å¿—ç­‰ï¼‰ã€‚
- ä¸æµè¡Œåº“å¦‚ TypeORMã€Prismaã€Mongoose ç­‰æ— ç¼é›†æˆã€‚

6. æ´»è·ƒçš„ç¤¾åŒºå’Œæ–‡æ¡£
- å®˜æ–¹æ–‡æ¡£æ¸…æ™°ï¼Œç¤¾åŒºæ´»è·ƒï¼Œé—®é¢˜èƒ½è¿…é€Ÿå¾—åˆ°è§£å†³ã€‚
- æœ‰å¤§é‡å­¦ä¹ èµ„æºå’Œå¼€æºé¡¹ç›®å¯å‚è€ƒã€‚

## ğŸ’» å®‰è£…

```bash
npm i -g @nestjs/cli
nest new project-name

# ä½ å–œæ¬¢ç”¨å“ªç§å®‰è£…ï¼Ÿ
? Which package manager would you â¤ï¸  to use?
  npm
â¯ yarn ï¼ˆæˆ‘å¸¸ç”¨ï¼‰
  pnpm

# é€‰æ‹©åï¼Œç‚¹å‡»å›è½¦
â–¸â–¹â–¹â–¹â–¹ Installation in progress... â˜•

# çœ‹åˆ°ä¸‹é¢çš„è¡¨ç¤ºå®‰è£…æˆåŠŸ
ğŸš€  Successfully created project base-nestjs
ğŸ‘‰  Get started with the following commands:

$ cd base-nestjs
$ yarn run start

                                         
                          Thanks for installing Nest ğŸ™
                 Please consider donating to our open collective
                        to help us maintain this package.
                                         
                                         
               ğŸ·  Donate: https://opencollective.com/nest
                                         
```

## ç›®å½•æ ‘è¯´æ˜

```bash
code
â””â”€â”€ base-nestjs
    â”œâ”€â”€ README.md                  # ğŸ“„ é¡¹ç›®è¯´æ˜æ–‡æ¡£ï¼Œè®°å½•é¡¹ç›®ä»‹ç»ã€å®‰è£…ä½¿ç”¨æ–¹å¼ç­‰ä¿¡æ¯
    â”œâ”€â”€ eslint.config.mjs          # ğŸ”§ ESLint é…ç½®æ–‡ä»¶ï¼Œç”¨äºä»£ç é£æ ¼å’Œè¯­æ³•è§„èŒƒæ£€æŸ¥
    â”œâ”€â”€ nest-cli.json              # âš™ï¸ Nest CLI é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰ç¼–è¯‘ã€ç”Ÿæˆç»“æ„ç­‰è¡Œä¸º
    â”œâ”€â”€ package.json               # ğŸ“¦ Node é¡¹ç›®ä¾èµ–ä¸è„šæœ¬é…ç½®ï¼Œè®°å½•ä¾èµ–åŒ…ã€å¯åŠ¨è„šæœ¬ç­‰
    â”œâ”€â”€ src                        # ğŸ§  ä¸»æºç ç›®å½•
    â”‚   â”œâ”€â”€ app.controller.spec.ts # âœ… app.controller çš„å•å…ƒæµ‹è¯•æ–‡ä»¶ï¼ˆä½¿ç”¨ Jest ç¼–å†™ï¼‰
    â”‚   â”œâ”€â”€ app.controller.ts      # ğŸ® æ§åˆ¶å™¨ï¼Œå¤„ç†è¯·æ±‚å¹¶è¿”å›å“åº”ï¼ˆå¦‚å®šä¹‰è·¯ç”±å¤„ç†é€»è¾‘ï¼‰
    â”‚   â”œâ”€â”€ app.module.ts          # ğŸ“¦ æ ¹æ¨¡å—ï¼Œç»„ç»‡å’Œå¯¼å…¥åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨çš„æ‰€æœ‰æ¨¡å—
    â”‚   â”œâ”€â”€ app.service.ts         # ğŸ› ï¸ æœåŠ¡ç±»ï¼Œå¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¾› controller è°ƒç”¨
    â”‚   â””â”€â”€ main.ts                # ğŸš€ åº”ç”¨ç¨‹åºçš„å…¥å£æ–‡ä»¶ï¼Œå¯åŠ¨ Nest åº”ç”¨å®ä¾‹
    â”œâ”€â”€ test                       # ğŸ§ª E2E æµ‹è¯•ç›®å½•ï¼ˆç«¯åˆ°ç«¯æµ‹è¯•ï¼‰
    â”‚   â”œâ”€â”€ app.e2e-spec.ts        # âœ… E2E æµ‹è¯•ç”¨ä¾‹ï¼Œæµ‹è¯•æ•´ä¸ªåº”ç”¨æ¥å£æ˜¯å¦æ­£å¸¸è¿è¡Œ
    â”‚   â””â”€â”€ jest-e2e.json          # ğŸ§¾ Jest çš„ E2E æµ‹è¯•é…ç½®æ–‡ä»¶
    â”œâ”€â”€ tsconfig.build.json        # ğŸ› ï¸ ç”¨äºæ„å»ºï¼ˆbuildï¼‰çš„ TypeScript é…ç½®æ–‡ä»¶
    â”œâ”€â”€ tsconfig.json              # ğŸ› ï¸ å…¨å±€ TypeScript é…ç½®æ–‡ä»¶ï¼ˆç¼–è¯‘é€‰é¡¹ã€è·¯å¾„åˆ«åç­‰ï¼‰
    â””â”€â”€ yarn.lock                  # ğŸ“Œ Yarn ç”Ÿæˆçš„é”å®šæ–‡ä»¶ï¼Œç”¨äºé”å®šä¾èµ–ç‰ˆæœ¬ä»¥ç¡®ä¿ä¸€è‡´æ€§

```

> ä¸‹é¢æˆ‘é€‰ç›¸å…³çš„æ–‡ä»¶æ¥è¯¦ç»†è¯´ä¸‹ï¼Œcontrollerã€serviceã€moduleã€test åé¢ä¼šæœ‰æ–‡ç« è¯¦ç»†è¯´æ˜

### nestjs-cli.json

è¿™ä¸ªé…ç½®æ–‡ä»¶ç”¨äºå‘Šè¯‰ Nest CLI å¦‚ä½•è¿è¡Œä»£ç ç”Ÿæˆå™¨ã€ç¼–è¯‘é¡¹ç›®ç­‰ã€‚

```js
{
  "$schema": "https://json.schemastore.org/nest-cli", // âœ… JSON Schema è¯´æ˜æ–‡ä»¶ï¼Œæä¾›ç¼–è¾‘å™¨æ™ºèƒ½æç¤ºä¸æ ¡éªŒæ”¯æŒ
  "collection": "@nestjs/schematics",                 // ğŸ§± æŒ‡å®šä½¿ç”¨çš„ schematics é›†åˆï¼ˆNestJS çš„ä»£ç ç”Ÿæˆæ¨¡æ¿ï¼‰
  "sourceRoot": "src",                                // ğŸ“‚ æºç æ ¹ç›®å½•ï¼ŒCLI ä¼šåœ¨è¿™ä¸ªç›®å½•ä¸­ç”Ÿæˆä»£ç ï¼ˆå¦‚æ¨¡å—ã€æ§åˆ¶å™¨ã€æœåŠ¡ç­‰ï¼‰
  "compilerOptions": {
    "deleteOutDir": true                              // ğŸ§¹ ç¼–è¯‘å‰æ˜¯å¦è‡ªåŠ¨åˆ é™¤ dist ç›®å½•ï¼ˆå³ä¸Šæ¬¡ç¼–è¯‘è¾“å‡ºï¼‰
  }
}

```

### main.ts (å…¥å£æ–‡ä»¶)

```js
import { NestFactory } from '@nestjs/core';      // ä» @nestjs/core ä¸­å¯¼å…¥ Nest å·¥å‚æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºåº”ç”¨å®ä¾‹
import { AppModule } from './app.module';        // å¯¼å…¥åº”ç”¨çš„æ ¹æ¨¡å— AppModule

async function bootstrap() {                     // å®šä¹‰å¼‚æ­¥å¯åŠ¨å‡½æ•° bootstrap
  const app = await NestFactory.create(AppModule); // åˆ›å»º Nest åº”ç”¨å®ä¾‹ï¼ˆæ³¨å…¥ AppModule æ¨¡å—ï¼‰
  
  //====å¸¸ç”¨é€‰é¡¹å¼€å§‹====
    
  app.enableCors();                            //  å¯ç”¨è·¨åŸŸæ”¯æŒ
  app.setGlobalPrefix('api');                 //  æ‰€æœ‰è·¯ç”±æ·»åŠ å‰ç¼€ /api
  
  //====å¸¸ç”¨é€‰é¡¹ç»“æŸ====
  
  
  await app.listen(process.env.PORT ?? 3000);      // å¯åŠ¨ç›‘å¬ç«¯å£ï¼Œä¼˜å…ˆä½¿ç”¨ç¯å¢ƒå˜é‡ PORTï¼Œå¦åˆ™é»˜è®¤ 3000
}

bootstrap();                                     // è°ƒç”¨å¯åŠ¨å‡½æ•°ï¼Œè¿è¡Œåº”ç”¨

```







